========================================================
ğŸš¨  URGENT: GATING STILL BROKEN
--------------------------------------------------------
Your previous implementation did NOT truly block the chat
bar until BOTH a contract file is uploaded and a party is
selected. Either the modal does not appear, or the chat input
is enabled too early. You must connect the **state logic**
all the way through the event flow.

========================================================
ğŸ›   HOW TO FIX (Do this exactly)
--------------------------------------------------------
1. Start with `conversationState = "idle"` (chat input DISABLED)
2. When user clicks â€œ+ New Contract Chatâ€ or uploads a file:
    â€“ Save the contract file metadata.
    â€“ Set `conversationState = "awaitingParty"`
    â€“ RENDER the party-selection modal ON TOP of everything
      (it must not be closable except by selecting a party)
3. Only after the user selects [First Party], [Second Party],
   or [General], update BOTH:
    â€“ Store partyRole in chat context
    â€“ Set `conversationState = "ready"`
    â€“ ENABLE the chat input bar
    â€“ Remove the modal
4. The chat bar must stay fully DISABLED (greyed out,
   pointer-events: none, disabled cursor) until BOTH steps above
   have happened (contract uploaded & party selected)
5. If the user tries to type/send when input is disabled, show
   a toast: "Please upload a contract first and select your party"
6. After that, chat streaming and Recent Contracts saving must
   work as before.
7. On page reload, reset conversationState to "idle" every time.

========================================================
âœ…  DONE CHECKLIST (test yourself)
--------------------------------------------------------
â˜ Chat bar is disabled on page load
â˜ Clicking â€œNew Contract Chatâ€ opens file dialog
â˜ Uploading a file always triggers the party modal
â˜ Chat stays locked until party selected
â˜ After party pick, input enables and streaming/chatting works
â˜ No way to close modal except picking a party
â˜ Toast appears if user tries to type while disabled
â˜ Log **CONTRACT GATE FULLY FIXED** in console

**Do not change any styles, layout, dark/light theme, header, sidebar, or chat API. Only wire the gating logic!**

========================================================
